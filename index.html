<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Q.SAP CHECK</title>
  <meta name="description" content="Q.SAP CHECK" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="mobile-web-app-capable" content="yes">
  <link rel="shortcut icon" type="image/png" href="1WK9AZ6cilSXDFR1WGFESY_FhZ2Aae0qD" />
  <link rel="apple-touch-icon" href="1WK9AZ6cilSXDFR1WGFESY_FhZ2Aae0qD" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  
  <style>
    body, html {
      margin: 0;
      padding: 0;
      font-family: 'Arial', sans-serif;
      height: 100%;
      background-color: #f5f5f5;
    }

    #content {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-color: white;
    }

    iframe {
      width: 100%;
      height: 100%;
      border: 0;
    }

    #homeBtn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background-color: #333;
      color: white;
      border: none;
      font-size: 24px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      transition: background-color 0.3s;
      z-index: 1000;
    }

    #homeBtn:hover {
      background-color: #555;
    }

    #loadingOverlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(255, 255, 255, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 2000;
    }

    .spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #333;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div id="loadingOverlay">
    <div class="spinner"></div>
  </div>

  <div id="content">
    <iframe id="myIframe" src="https://script.google.com/macros/s/AKfycbyJ7idwYQQmtQU8Qi9PgrAVDUa6caK_h_dpFSRXSkqFbS5UoiLZVSvKaPB6aJlocl4/exec"></iframe>
    <button id="homeBtn"><i class="fas fa-home"></i></button>
  </div>

  <script>
    const iframe = document.getElementById('myIframe');
    const loadingOverlay = document.getElementById('loadingOverlay');
    const homeBtn = document.getElementById('homeBtn');

    function showLoading() {
      loadingOverlay.style.display = 'flex';
    }

    function hideLoading() {
      loadingOverlay.style.display = 'none';
    }

    iframe.onload = function() {
      hideLoading();
    };

    iframe.onerror = function() {
      alert('ไม่สามารถโหลดเนื้อหาได้ กรุณาลองใหม่อีกครั้ง');
      hideLoading();
    };

    homeBtn.addEventListener('click', function() {
      showLoading();
      iframe.src = 'https://script.google.com/macros/s/AKfycbyJ7idwYQQmtQU8Qi9PgrAVDUa6caK_h_dpFSRXSkqFbS5UoiLZVSvKaPB6aJlocl4/exec';
    });

    window.addEventListener('message', function(event) {
      if (event.origin !== 'https://script.google.com') return;
      
      if (event.data === 'iframeLoaded') {
        hideLoading();
      }
    });

    showLoading(); // Show loading when the page first loads
  </script>
</body>
</html>
